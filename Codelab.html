<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ol{margin:0;padding:0}table td,table th{padding:0}.c2{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left;height:11pt}.c1{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c3{background-color:#ffffff;max-width:451.4pt;padding:72pt 72pt 72pt 72pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c3 doc-content"><p class="c1"><span class="c2"># Configuring Cisco Devices with Ansible on Google Cloud Platform</span></p><p class="c1"><span class="c2">Duration: 45 minutes</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">## Overview</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">This codelab will guide you through the process of using Ansible to configure Cisco devices while leveraging Google Cloud Platform (GCP). You&#39;ll learn how to create and manage network configurations using Infrastructure as Code principles, combining the power of Ansible automation with GCP&#39;s cloud infrastructure.</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">### What you&#39;ll learn</span></p><p class="c1"><span class="c2">- How to structure Ansible playbooks for Cisco device configuration</span></p><p class="c1"><span class="c2">- Setting up firewall rules and VLANs using Ansible</span></p><p class="c1"><span class="c2">- Deploying and running Ansible playbooks on Google Cloud Platform</span></p><p class="c1"><span class="c2">- Best practices for network automation in the cloud</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">### Prerequisites</span></p><p class="c1"><span class="c2">- Basic understanding of Ansible</span></p><p class="c1"><span class="c2">- Familiarity with Cisco networking concepts</span></p><p class="c1"><span class="c2">- A Google Cloud Platform account</span></p><p class="c1"><span class="c2">- Basic knowledge of YAML syntax</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">## Setting up the Project Structure</span></p><p class="c1"><span class="c2">Duration: 5 minutes</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">First, let&#39;s create the proper directory structure for our Ansible project:</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">```bash</span></p><p class="c1"><span class="c2">ansible/</span></p><p class="c1"><span class="c2">&#9500;&#9472;&#9472; configure_cisco_devices.yml</span></p><p class="c1"><span class="c2">&#9500;&#9472;&#9472; roles/</span></p><p class="c1"><span class="c2">&#9474; &nbsp; &#9500;&#9472;&#9472; configure_device/</span></p><p class="c1"><span class="c2">&#9474; &nbsp; &#9474; &nbsp; &#9492;&#9472;&#9472; tasks/</span></p><p class="c1"><span class="c2">&#9474; &nbsp; &#9474; &nbsp; &nbsp; &nbsp; &#9492;&#9472;&#9472; main.yml</span></p><p class="c1"><span class="c2">```</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">This structure follows Ansible best practices and makes our code modular and maintainable.</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">## Creating the Base Configuration Playbook</span></p><p class="c1"><span class="c2">Duration: 10 minutes</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">Let&#39;s create our main playbook for configuring Cisco devices. Create a file named `configure_cisco_devices.yml`:</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">```yaml</span></p><p class="c1"><span class="c2">---</span></p><p class="c1"><span class="c2">- name: Configure Cisco Devices</span></p><p class="c1"><span class="c2">&nbsp; hosts: cisco</span></p><p class="c1"><span class="c2">&nbsp; gather_facts: no</span></p><p class="c1"><span class="c2">&nbsp; roles:</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; - configure_device</span></p><p class="c1"><span class="c2">```</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">Next, create the role&#39;s main task file at `roles/configure_device/tasks/main.yml`:</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">```yaml</span></p><p class="c1"><span class="c2">---</span></p><p class="c1"><span class="c2">- name: Configure Cisco Devices</span></p><p class="c1"><span class="c2">&nbsp; ios_config:</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; lines:</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; - access-list 100 permit ip any any</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; - interface GigabitEthernet0/0</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; - ip access-group 100 in</span></p><p class="c1"><span class="c2">&nbsp; register: config_result</span></p><p class="c1"><span class="c2">&nbsp; when: &quot;&#39;firewall_enabled&#39; not in config_result.stdout_lines | join(&#39; &#39;)&quot;</span></p><p class="c1"><span class="c2">```</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">## Creating the Configuration Verification Playbook</span></p><p class="c1"><span class="c2">Duration: 10 minutes</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">Create a new file named `check_cisco_configuration.yml`:</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">```yaml</span></p><p class="c1"><span class="c2">---</span></p><p class="c1"><span class="c2">- name: Check Cisco Configuration</span></p><p class="c1"><span class="c2">&nbsp; hosts: cisco</span></p><p class="c1"><span class="c2">&nbsp; gather_facts: no</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">&nbsp; tasks:</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; - name: Gather Cisco Configuration</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; ios_command:</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; commands:</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - show running-config</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; register: config_result</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp; - name: Verify Firewall Configuration</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; debug:</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; msg: &quot;Firewall is configured&quot;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; when: &quot;&#39;ip access-group 100 in&#39; in config_result.stdout&quot;</span></p><p class="c1"><span class="c2">```</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">## Setting up the Inventory</span></p><p class="c1"><span class="c2">Duration: 5 minutes</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">Create an inventory file named `inventory.ini`:</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">```ini</span></p><p class="c1"><span class="c2">[cisco]</span></p><p class="c1"><span class="c2">cisco-device-1 ansible_host=192.168.1.1 ansible_user=username ansible_password=password</span></p><p class="c1"><span class="c2">cisco-device-2 ansible_host=192.168.1.2 ansible_user=username ansible_password=password</span></p><p class="c1"><span class="c2">```</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">## Enhanced Firewall Configuration</span></p><p class="c1"><span class="c2">Duration: 10 minutes</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">Let&#39;s create a comprehensive playbook that includes firewall and VLAN configurations. Create `enable_firewall.yml`:</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">```yaml</span></p><p class="c1"><span class="c2">---</span></p><p class="c1"><span class="c2">- name: Configure Cisco Devices</span></p><p class="c1"><span class="c2">&nbsp; hosts: cisco</span></p><p class="c1"><span class="c2">&nbsp; gather_facts: no</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">&nbsp; tasks:</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; - name: Configure Firewall</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; ios_config:</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; lines:</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - access-list 100 permit ip any any</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - interface GigabitEthernet0/0</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - ip access-group 100 in</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; register: config_result</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; when: &quot;&#39;firewall_enabled&#39; not in config_result.stdout_lines | join(&#39; &#39;)&quot;</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp; - name: Configure VLANs</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; ios_config:</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; lines:</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - vlan 10</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - name Server_VLAN</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - interface Vlan10</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - ip address 192.168.10.1 255.255.255.0</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; when: &quot;&#39;Server_VLAN&#39; not in config_result.stdout_lines | join(&#39; &#39;)&quot;</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">&nbsp; vars:</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; ansible_user: your_ssh_username</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; ansible_password: your_ssh_password</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; ansible_become: yes</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; ansible_become_method: enable</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; ansible_become_password: your_enable_password</span></p><p class="c1"><span class="c2">```</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">## Deploying to Google Cloud Platform</span></p><p class="c1"><span class="c2">Duration: 15 minutes</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">Now let&#39;s set up and run our playbooks on GCP:</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">1. Create two Google Compute Engine instances</span></p><p class="c1"><span class="c2">2. Install Ansible on the instances</span></p><p class="c1"><span class="c2">3. Upload your playbooks using:</span></p><p class="c1"><span class="c2">```bash</span></p><p class="c1"><span class="c2">gcloud compute scp configure_cisco_devices.yml your-inventory.ini your-username@instance-name:~/</span></p><p class="c1"><span class="c2">```</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">4. SSH into your instances:</span></p><p class="c1"><span class="c2">```bash</span></p><p class="c1"><span class="c2">gcloud compute ssh your-username@instance-name</span></p><p class="c1"><span class="c2">```</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">5. Run the playbooks:</span></p><p class="c1"><span class="c2">```bash</span></p><p class="c1"><span class="c2">ansible-playbook configure_cisco_devices.yml -i your-inventory.ini</span></p><p class="c1"><span class="c2">ansible-playbook check_cisco_configuration.yml -i your-inventory.ini</span></p><p class="c1"><span class="c2">ansible-playbook enable_firewall.yml -i your-inventory.ini</span></p><p class="c1"><span class="c2">```</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">## Conclusion</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">Congratulations! You&#39;ve successfully:</span></p><p class="c1"><span class="c2">- Created a structured Ansible project for network automation</span></p><p class="c1"><span class="c2">- Implemented playbooks for configuring Cisco devices</span></p><p class="c1"><span class="c2">- Set up verification and monitoring</span></p><p class="c1"><span class="c2">- Deployed your automation solution on Google Cloud Platform</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">### What we&#39;ve covered</span></p><p class="c1"><span class="c2">- Ansible playbook structure and organization</span></p><p class="c1"><span class="c2">- Cisco device configuration automation</span></p><p class="c1"><span class="c2">- GCP integration with network automation</span></p><p class="c1"><span class="c2">- Best practices for network configuration management</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">### Next Steps</span></p><p class="c1"><span class="c2">- Explore more complex network configurations</span></p><p class="c1"><span class="c2">- Implement automated testing</span></p><p class="c1"><span class="c2">- Add monitoring and logging</span></p><p class="c1"><span class="c2">- Integrate with CI/CD pipelines</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">### Learn More</span></p><p class="c1"><span class="c2">- [Ansible Documentation](https://docs.ansible.com)</span></p><p class="c1"><span class="c2">- [Cisco DevNet](https://developer.cisco.com)</span></p><p class="c1"><span class="c2">- [Google Cloud Platform Documentation](https://cloud.google.com/docs)</span></p><p class="c0"><span class="c2"></span></p></body></html>